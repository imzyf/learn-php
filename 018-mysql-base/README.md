# MySQL 基础

## 数据类型

### 数值

- `int(3)` 中的 3 是显示的长度，zerofill 零填充，根据长度补 0。
- decimal 可以存储比 bigint 还大的整数。可以用于存储精确的小数。（当字符串处理？）

### 字符串

- varchar 可变长字符串，比定长类型更节省空间。小于 255 字节时，使用 1 个字节记录字符串长度，否则 2 个。存储超过长度，会被截断。
- char 定长，根据定义的字符串分配足够的空间。根据需要采用空格填充。适合存储很短的字符串，或者接近长度。超出截断。
- 对于经常变更的数据 char 比 varchar 好，char 不容易产生碎片。
- 对于非常短的列，char 比 varchar 存储上更有效率。
- 尽量避免使用 text/blob 查询会使用临时表，导致严重的性能开销。

### 枚举

- 枚举，内部是整数。避免使用数字，产生混乱，排序是根据内部整数。

### 日期时间

- timestamp 比 datetime 空间效率高。
- 用整数保存时间戳的格式通常不方便处理。
- 微秒可以使用 bigint 存储。

### 列属性

- `auto_increment` `default` `not null` `zerofill`

## 基础操作

- mysql -u -p -h -P
- `\G` 结果垂直显示
- `\c` 取消当前命令
- `\q` 退出
- `\s` 显示 MySQL 状态
- `\h` 帮助信息
- `\d` 改变执行符

## 表引擎

### InnoDb

- 事务型引擎，性能优秀
- 数组存储在共享表空间，可以通过配置分开
- 内部有优化，从磁盘读取数据时自动在内存构建 hash 索引，插入数据时自动构建插入缓冲区
- 支持热备份
- 支持崩溃后的安全恢复
- 支持行级锁
- 支持外键

### MyISAM

- 5.1 前是默认存储引擎
- 拥有全文索引、压缩、空间函数
- 不支持事务和行级锁
- 存储在 MYD MYI

### 其他

- CSV
- memory
- archive

## 锁机制

- 读锁 共享锁
- 写锁 排他锁
- 锁粒度 MyISAM 标锁，InnoDB 行级锁

## 事务处理

- InnoDB
- 在非事务的表上执行事务操作，MySQL 不会发出提醒，不会报错

## 存储过程

- 一条或者多条命令集合

## 触发器

- 级联更改